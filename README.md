# C语言控制台五子棋 (Gobang)

这是一个基于 C 语言开发的控制台五子棋游戏。支持人人对战（PVP）和人机对战（PVE）模式。游戏实现了包含禁手规则（Renju Rules）的逻辑，并搭载了一个具有一定棋力的 AI。

## 📁 文件结构

*   **`gobang.c`**: 主程序文件。包含 `main` 函数、游戏主循环、界面显示（棋盘绘制）、用户输入处理以及胜负判定逻辑。
*   **`evaluate.c`**: AI 核心逻辑文件。包含极大极小值算法（Minimax）、Alpha-Beta 剪枝、迭代加深搜索、Zobrist 置换表以及局势评估函数。
*   **`forbidden.c`**: 禁手规则判断文件。专门用于检测黑棋的“三三禁手”、“四四禁手”和“长连禁手”。
*   **`myhead.h`, `evaluate.h`, `forbidden.h`**: 相关的头文件，用于函数声明,类型定义和宏定义。

## ✨ 功能特性

1.  **游戏模式**:
    *   **PVP (人人对战)**: 两位玩家轮流落子，黑棋先行，严格执行禁手规则。
    *   **PVE (人机对战)**: 玩家与 AI 对战，支持选择先手或后手。

2.  **智能 AI**:
    *   **核心算法**: Minimax 搜索 + Alpha-Beta 剪枝。
    *   **性能优化**: 使用 **Zobrist Hashing (置换表)** 缓存搜索结果，大幅提高搜索效率。
    *   **搜索策略**: 采用 **迭代加深 (Iterative Deepening)**，并在规定时间（约 8 秒）内尽可能搜索更深层数
    *   **首步策略**: AI 若先行，首子默认天元（棋盘中心）。

3.  **规则实现**:
    *   **基本胜负**: 任意方向连成 5 子获胜。
    *   **禁手规则**:
        *   **长连禁手**: 连成 6 个或以上黑子（白棋获胜）。
        *   **三三禁手**: 同时形成两个活三。
        *   **四四禁手**: 同时形成两个四（活四或冲四）。
        *   *例外*: 如果黑棋下出禁手的同时连成五子，则五子优先，黑棋获胜。

4.  **界面交互**:
    *   使用 UTF-8 字符 (`┏`, `┼`, `●`, `◎`) 绘制美观的棋盘。
    *   实时显示最后落子位置、AI 思考用时。
    *   坐标系：行号 (1-15) + 列号 (A-O)。

## 🛠️ 编译与运行

本项目依赖 GCC 编译器。由于使用了 Linux 特有的清屏指令 `system("clear")`，建议在 **Linux** 或 **macOS** 环境下运行。Windows 用户需将代码中的 `system("clear")` 修改为 `system("cls")` 并确保终端支持 UTF-8。

### 编译指令

```bash
gcc gobang.c evaluate.c forbidden.c -o gobang
```

*(注意：请确保你的目录下包含相应的头文件)*

### 运行

```bash
./gobang
```

##  操作说明

1.  **启动**: 运行程序后，输入 `1` 选择人人对战，或输入 `0` 选择人机对战。
2.  **PVE 选边**: 若选择人机模式，输入 `1` 为玩家先手（黑棋），输入 `2` 为 AI 先手（黑棋）。
3.  **落子输入**:
    *   轮到玩家落子时，按照 **`行号 列号`** 的格式输入。
    *   **行号**: 1 ~ 15
    *   **列号**: A ~ O (不区分大小写，但建议大写)
    *   **示例**: 输入 `8 H` 表示在第 8 行 H 列（即天元位置）落子。
4.  **游戏结束**: 达成五连珠或判定禁手后，程序宣布胜者并退出。

##  技术细节(AI 部分)

*   **威胁判断**: 在生成走法前，优先检测对手的“四”和“活三”，进行强制防守，避免被瞬杀。
*   **搜索剪枝**: 通过 Alpha-Beta 剪枝减少不必要的节点搜索。
*   **置换表 (TT)**: 解决了重复局面的计算问题，使用 `xor` 运算快速更新 Zobrist Hash。
*   **时间控制**: 设置了超时标志，确保 AI 在思考时间过长时（>8s）能及时返回当前最优解。

##  注意事项

*   **编码格式**: 源代码文件和终端环境必须使用 **UTF-8** 编码，否则棋盘字符可能会显示为乱码。
*   **输入检查**: 程序包含输入容错处理，若输入格式错误或坐标越界，会提示重新输入。

##  作者

*   Work of **李丰廷**